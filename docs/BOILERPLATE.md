# Boilerplate 
All project types include all of the content outlined below. You can choose the first option 'New App with just the boilerplate' for the project type 
if you only want these files. See the [high level usage overview][usage-overview-url] for more details.

## Directory Structure & Files
The generator will create the following boilerplate directory structure and files for you. Note that if you pick a different project type, then the generator may
create additional files and/or directories for you. Also note that you won't have the 'node_modules' directory if you tell the generator to not install dependencies for your project (*and if you tell the generator you want [VS Code content][vscode-doc], then the node_modules directory will be hidden by default*) 
  
Here is what you will see in VS Code if you have the generator include VS Code Files (*again note that node_modules is intentionally hidden in VS Code settings*):  
![VS Code Directory Structure][boilerplate-vscode-dir-image]    

And here is what you will see without VS Code Content:  
![Sans VS Code Directory Structure][boilerplate-dir-image]  
  
See the below sections for detailed information about the [standard files][standard-section], [gulp tasks/building][building-section], [linting][linting-section],
[testing with mocha and istanbul][testing-section], [git hooks][git-hooks-section], and [npm scripts][npm-scripts-section].


## Standard Files
Naturally, the below common files are created for you by the generator. 

- *.gitignore*
- *package.json*
- *README.md*
- *.npmignore*
- *tsconfig.json*

## Gulp & Building
There is a `gulpfile.js` created in the root of the project directory, however, all of the gulp tasks are defined within the `tasks` subdirectory within the `gulp` directory. **Note** that we do NOT
recommend installing gulp globally, so most of these tasks are wrapped by an npm script ([details below][npm-scripts-section]) which allows them to be executed through npm without requiring gulp to be installed globally.

![Gulp Tasks][gulp-tasks-image]  
  
The configuration values for the various gulp tasks are contained with the files prefixed with `*-config.js`. The individual gulp tasks are contained within the respective files
under the 'tasks' directory. 

### Tasks
Again we recommend using the corresponding [`npm scripts`][npm-scripts-section] to execute these gulp tasks. We also recommend telling the generator to include the [VS Code][vscode-doc] content in your project because it will give you status bar tasks that will provide these capabilities at the click of a button!

`build.js`

- *transpile*: Takes the source TypeScript and emits JavaScript.

`clean.js`

- *clean*: Removes the JavaScript files & maps generated by the transpilation process.

`lint.js`

- *eslint*: Executes eslint.
- *tslint*: Executes tslint.

`test.js`

- *_check-security_*: Runs the NSP utility to check for security issues.
- *pre-unit-tests*: Performs setup for executing unit tests. This task is more about clean task functions and **should not** be run in isolation
- *run-unit-tests*: Executes unit tests. 
- *enforce-code-coverage*: Runs unit tests and uses [istanbul][istanbul-url] to validate code coverage meets thresholds defined in the `istanbul-config.js` file
- *show-unit-test-coverage-report*: Opens the html code coverage report in the default browser. Use this to locally see a detailed line by line breakdown of code coverage, example below.  
  
![Istanbul Coverage][istanbul-html-report-image]

## Linting
The generator adds support for two linters to your project: [TSLint][tslint-url] for TypeScript and [ESLint][eslint-url] for JavaScript. Why both you may ask? Because the projects the generator creates include both .js files and .ts files, and we think it is important to follow a set of standards in both. Additionally, TSLint and ESLint each have their strengths (one is better for rule X whereas the other is better at rule Y), and together they can help you keep a clean and consistent codebase.  

The configuration files for these
can be found in the root of the project directory created by the generator. The recommended method for running these linters is via the [npm script outlined below][npm-scripts-section].

- *.eslintignore* - Specifies which files/directories to exclude from ESLint analysis.
- *.eslintrc.js* - Specifies the ESLint rule configuration to use for analysis.
- *tslint.json* - Specifies the TSLint rule configuration to use for analysis.  
  
Note that the [Microsoft TSLint rules][tslint-microsoft-url] have been added to the TSLint rule configuration as well.  

## Testing
The generator creates the testing setup for your project with the following components: 

- [Mocha][mocha-url] - For the test framework/runner
- [Chai][chai-url] - For the assertion library
- [Sinon][sinon-url] - For stubs/mocks/spies/etc.
- [Istanbul][istanbul-url] - For code coverage, enforcement, and instrumentation

The recommended method for running tests and calculating code coverage is to use the [npm script outlined below][npm-scripts-section].  
  
By default, the tests use Mocha's TDD testing interface with a 2 second timeout, and leverage the [mocha-multi][mocha-multi-url] module to leverage the spec/stdout reporter as well
as the xunit reporter to write the test results to a file in the xunit format (which can be used to import/upload the results into certain CI/build tools). This configuration is defined
in the `mocha-config.js` file within the `gulp` directory.

### Coverage
Code coverage is calculated and enforced with [Istanbul][istanbul-url]. The values for the reporters, coverage thresholds, and more are defined in the file `istanbul-config.js` 
within the `gulp` directory.

## Git Hooks
The generator adds modules that allow you to leverage the client side [git hooks][git-hooks-url] in order to perform various validation steps. Currently, the generator configures
your project to leverage the 'pre-commit' hook. This will execute a series of steps, defined by you, that will automatically be performed prior to the git commit being finalized. 
This allows you do things like lint or run tests to verify your code changes prior to them being commited. This pre-commit step can be bypassed via a 
`git commit --no-verify` if desired. 

There is also a 'pre-push' hook if you would like to be able to execute these same types of validation steps prior to pushing your changes to the remote repo.
This can be done in addition to, or instead of, the pre-commit hook. We are currently discussing enhancing the capabilities of the generator to allow you to pick which (if any) hook you want for your new project. Feel free to share any thoughts or ideas on our [git hook enhancement thread][git-hook-enhancement-issue].

The steps that will be automatically executed are defined within the 'pre-commit' array in the generated `package.json`. The values in this array must represent the name of a script defined
within the npm scripts section in the `package.json`. The generator will set your initial configuration for the pre-commit hook to execute three of the npm scripts: check-security, 
enforce-code-coverage, and lint.

![Pre-Commit][package-json-image]  
  
You will notice the hook scripts executing after you do a git commit:  
  
![Git Commit Hook][git-commit-cli]

## NPM Scripts
npm scripts are a quick and convenient way to execute a variety activities. We recommend leveraging these whenever and wherever possible. They are especially useful for dependencies local 
to the project, as it eliminates the need to install those globally and prevents needing to use hardcoded paths into the node_modules directory. 

Scripts can be executed via the shorthand:
```sh
npm run *script name*
```  
  
The generator creates the following npm scripts for your project:

- *build* - Single npm script that can be used to run all of your steps/tasks, such as during a build/CI process.
- *check-security* - Executes the NSP utility against your project to check for any known security.
- *clean* - Removes the JavaScript files and maps generated by the transpilation process.
- *component-test* - Runs the component integration tests
- *enforce-code-coverage* - Checks current code coverage against the defined thresholds.
- *gulp* - Wrapper around gulp so that individual gulp tasks can be executed without needing gulp installed globally. Usage would look like `npm run gulp -- *gulp-task-name*`
- *lint* - Executes all of the linting engines.
- *show-component-integration-test-coverage* - Runs the component integration tests, calculates the code coverage and displays the results in the default browser.
- *show-unit-test-coverage* - Runs the unit tests, calculates the code coverage and displays the results in the default browser.
- *test* - Default script that runs both the `check-security` and `enforce-code-coverage` scripts.
- *transpile* - Transpiles the TypeScript to JavaScript.  
  
![Package.json][package-json-image]

[usage-overview-url]: USAGE-OVERVIEW.md
[building-section]: BOILERPLATE.md#gulp-&-building
[gulp-tasks-image]: images/gulp-tasks.png "Gulp Tasks"
[istanbul-html-report-image]: images/istanbul-coverage.png "Istanbul Coverage"
[linting-section]: BOILERPLATE.md#linting
[tslint-url]: https://palantir.github.io/tslint/
[tslint-microsoft-url]: https://github.com/Microsoft/tslint-microsoft-contrib
[eslint-url]: http://eslint.org/
[jshint-url]: http://jshint.com/
[testing-section]: BOILERPLATE.md#testing
[mocha-url]: https://mochajs.org/
[sinon-url]: http://sinonjs.org/
[chai-url]: http://chaijs.com/
[istanbul-url]: https://istanbul.js.org/
[mocha-multi-url]: https://www.npmjs.com/package/mocha-multi
[boilerplate-dir-image]: images/boilerplate-dir-structure.png "Boilerplate Directory Structure"
[boilerplate-vscode-dir-image]: images/boilerplate-vscode-dir-structure.png "Boilerplate VS Code Directory Structure"
[standard-section]: BOILERPLATE.md#standard-files
[git-hooks-section]: BOILERPLATE.md#git-hooks
[git-hooks-url]: https://www.git-scm.com/book/uz/v2/Customizing-Git-Git-Hooks
[git-commit-cli]: images/git-precommit-hook.png
[package-json-image]: images/package-json.png "Package.json"
[npm-scripts-section]: BOILERPLATE.md#npm-scripts
[vscode-doc]: VSCODE.md
[git-hook-enhancement-issue]: https://github.com/swellaby/generator-swell/issues/94